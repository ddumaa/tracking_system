<!DOCTYPE html>
<html lang="ru"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/layout}">

<head>
    <title layout:fragment="title">–¢–∞—Ä–∏—Ñ—ã</title>
</head>

<main layout:fragment="content" class="py-5">
    <div class="container-xl">

        <h1 class="text-center mb-4">–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∞—Ä–∏—Ñ</h1>

        <!-- üîò –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å -->
        <div class="text-center mb-4">
            <div class="btn-group" role="group">
                <button type="button" id="btn-monthly" class="btn btn-primary">–ú–µ—Å—è—Ü</button>
                <button type="button" id="btn-yearly" class="btn btn-outline-secondary">–ì–æ–¥</button>
            </div>
        </div>

        <div class="row justify-content-center g-4">

            <div class="col-md-6 col-lg-5" th:each="plan : ${plans}">
                <div class="card h-100 shadow-sm border-0 rounded-4 d-flex flex-column">

                    <!-- –ù–∞–∑–≤–∞–Ω–∏–µ -->
                    <h3 class="text-center fw-bold fs-3 mt-3 mb-1" th:text="${plan.name}">Premium</h3>
                    <p class="text-center text-muted mb-2" th:text="${plan.description}"></p>

                    <!-- –¶–µ–Ω–∞ (–µ–∂–µ–º–µ—Å—è—á–Ω–æ) -->
                    <p class="text-center mb-2 mt-2 fw-semibold fs-5 price-monthly text-dark"
                       th:if="${plan.monthlyPriceLabel != null}"
                       th:text="${plan.monthlyPriceLabel}">15 BYN/–º–µ—Å</p>

                    <p class="text-center mb-2 mt-2 fs-6 text-muted price-placeholder price-monthly"
                       th:unless="${plan.monthlyPriceLabel != null}">–ë–µ—Å–ø–ª–∞—Ç–Ω–æ</p>

                    <!-- –¶–µ–Ω–∞ (–µ–∂–µ–≥–æ–¥–Ω–æ) -->
                    <div class="price-yearly d-none text-center">
                        <p class="mb-1 fw-semibold fs-5 text-dark"
                           th:if="${plan.annualPriceLabel != null}"
                           th:text="${plan.annualPriceLabel}">150 BYN/–≥–æ–¥</p>

                        <p class="mb-2 text-muted small"
                           th:if="${plan.annualFullPriceLabel != null}">
                            <s th:text="${plan.annualFullPriceLabel}">180 BYN</s>
                            <span class="discount-label" th:text="${plan.annualDiscountLabel}">–≤—ã–≥–æ–¥–∞ ‚àí17%</span>
                        </p>
                    </div>

                    <p class="text-center mb-2 mt-2 fs-6 text-muted price-placeholder price-yearly d-none"
                       th:unless="${plan.annualPriceLabel != null}">–ë–µ—Å–ø–ª–∞—Ç–Ω–æ</p>

                    <div class="card-body px-4 d-flex flex-column">
                        <ul class="tariff-features list-unstyled mb-4 flex-grow-1">
                            <li>üì• –¢—Ä–µ–∫–æ–≤ –≤ —Ñ–∞–π–ª–µ:
                                <strong th:text="${plan.maxTracksPerFile != null ? plan.maxTracksPerFile : '–ë–µ–∑ –ª–∏–º–∏—Ç–∞'}"></strong>
                            </li>
                            <li>üíæ –°–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã—Ö —Ç—Ä–µ–∫–æ–≤:
                                <strong th:text="${plan.maxSavedTracks != null ? plan.maxSavedTracks : '–ë–µ–∑ –ª–∏–º–∏—Ç–∞'}"></strong>
                            </li>
                            <li>üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏–π –≤ –¥–µ–Ω—å:
                                <strong th:text="${plan.maxTrackUpdates != null ? plan.maxTrackUpdates : '–ë–µ–∑ –ª–∏–º–∏—Ç–∞'}"></strong>
                            </li>
                            <li>üè¨ –ú–∞–≥–∞–∑–∏–Ω–æ–≤:
                                <strong th:text="${plan.maxStores}"></strong>
                            </li>
                            <li>
                                <span th:if="${plan.allowBulkUpdate}">‚úÖ –ú–∞—Å—Å–æ–≤–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ</span>
                                <span th:unless="${plan.allowBulkUpdate}" class="text-muted">‚ùå –ú–∞—Å—Å–æ–≤–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ</span>
                            </li>
                            <li>
                                <span th:if="${plan.allowTelegramNotifications}">üì® Telegram-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</span>
                                <span th:unless="${plan.allowTelegramNotifications}" class="text-muted">‚ùå Telegram-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</span>
                            </li>
                        </ul>


                        <!-- ü§ù –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–∂–µ –Ω–∞ —ç—Ç–æ–º —Ç–∞—Ä–∏—Ñ–µ -->
                        <div th:if="${userProfile != null && userProfile.subscriptionCode == plan.code}" class="mt-auto">
                            <button class="btn btn-outline-secondary w-100" disabled
                                    th:text="${userProfile.subscriptionEndDate != null ? '–í–∞—à —Ç–∞—Ä–∏—Ñ–Ω—ã–π –ø–ª–∞–Ω –¥–æ ' + userProfile.subscriptionEndDate : '–í–∞—à —Ç–∞—Ä–∏—Ñ–Ω—ã–π –ø–ª–∞–Ω'}">
                            </button>
                        </div>

                        <!-- üîí FREE: —Ç–∞—Ä–∏—Ñ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é -->
                        <div th:if="${plan.code == 'FREE' && (userProfile == null || userProfile.subscriptionCode != plan.code)}" class="mt-auto">
                            <button class="btn btn-outline-secondary w-100" disabled th:text="–í–∞—à —Ç–∞—Ä–∏—Ñ">
                            </button>
                        </div>

                        <!-- ‚úÖ PREMIUM: –ø–µ—Ä–µ—Ö–æ–¥ –∏–ª–∏ –ø—Ä–æ–¥–ª–µ–Ω–∏–µ -->
                        <form th:if="${plan.code == 'PREMIUM' && (userProfile == null || userProfile.subscriptionCode != plan.code)}" th:action="@{/tariffs/upgrade}" method="post" class="mt-auto">
                            <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>
                            <input type="hidden" id="monthsInput" name="months" value="1"/>
                            <button type="submit" class="btn btn-primary w-100" th:text="–ü–µ—Ä–µ–π—Ç–∏ –Ω–∞ Premium">
                            </button>
                        </form>

                    </div>

                </div>
            </div>

        </div>
    </div>

    <script src="/js/tariffs.js"></script>

</main>

</html>